 {% extends '../base.html' %}
 
 {% block content %}
 <h1>Workflow:</h1>
 <pre><caption>This is the page where staff will be able to view all Loan Requests that have been approved for either the 
Basic or Standard Application, as well as all of the Basic and Standard Applications that have been submitted. 
From here, a staff member will be able to view the details of Basic or Standard Applications, change their 
workflow status, or update the tier if necessary.

Also included in this page is the ability to change a Loan Request to a different status, in case a Request was
unintentionally 'approved' for a Basic or Standard Application.
</caption></pre>
	<h2>Requests Approved for Basic Application:</h2>
	<h3>(Application Unsubmitted)</h3>
	{% if req_basic %}
		<table>
			<tr>
				<th>User</th>
				<th>Address of Property</th>
				<th>Contact Person</th>
				<th>Current Mortgage Balance</th>
				<th>Mortgage Amount Desired</th>
				<th>Phone Number</th>
				<th>Email Address</th>
				<th>Borrower Type</th>
				<th>Date Last Modified</th>
				<th>Status</th>
			</tr>
			{% for app in req_basic %}
			<tr>
				<td>{{ app.user.username }}</td>
				<td>{{ app.property.property_address }}</td>
				<td>{{ app.contact.name_last }}, {{ app.contact.name_first }}</td>
				<td>${{ app.curr_mortgage.current_balance | floatformat:2  }}</td>
				<td>${{ app.desired_mortgage.amount_desired | floatformat:2 }}</td>
				<td>{{ app.contact.phone }}</td>
				<td>{{ app.contact.email_address }}</td>
				<td>{{ app.borrower.get_type_display }}</td>
				<td>{{ app.submitted }}</td>
				<td>{{ app.get_status_display }}<br> <a href="req_{{ app.id }}" >Update</a></td>
			</tr>
			{% endfor %}
		</table>
	{% else %}
		<p>There are no Requests that have been approved for Basic Application</p>
	{% endif %}
	<br>
	<br>
	<h2>Requests Approved for Standard Application:</h2>
	<h3>(Application Unsubmitted)</h3>
	{% if req_standard %}
		<table>
			<tr>
				<th>User</th>
				<th>Address of Property</th>
				<th>Contact Person</th>
				<th>Current Mortgage Balance</th>
				<th>Mortgage Amount Desired</th>
				<th>Phone Number</th>
				<th>Email Address</th>
				<th>Borrower Type</th>
				<th>Date Last Modified</th>
				<th>Status</th>
			</tr>
			{% for app in req_standard %}
			<tr>
				<td>{{ app.user.username }}</td>
				<td>{{ app.property.property_address }}</td>
				<td>{{ app.contact.name_last }}, {{ app.contact.name_first }}</td>
				<td>${{ app.curr_mortgage.current_balance | floatformat:2  }}</td>
				<td>${{ app.desired_mortgage.amount_desired | floatformat:2 }}</td>
				<td>{{ app.contact.phone }}</td>
				<td>{{ app.contact.email_address }}</td>
				<td>{{ app.borrower.get_type_display }}</td>
				<td>{{ app.submitted }}</td>
				<td>{{ app.get_status_display }}<br> <a href="req_{{ app.id }}" >Update</a></td>
			</tr>
			{% endfor %}
		</table>
	{% else %}
		<p>There are no Requests approved for Standard Application</p>
	{% endif %}
	<br>
	<br>
 	<h2>Basic Applications:</h2>
	{% if basic %}
		<table>
			<tr>
				<th>User</th>
				<th>Property</th>
				<th>Borrower</th>
				<th>Status</th>
				<th>Source</th>
				<th>Date Last Modified</th>
			</tr>
			{% for app in basic %}
			<tr>
				<td>{{ app.user.username }}</td>
				<td>{{ app.property.address }}</td>
				<td>{{ app.borrower.name_last }}, {{ app.borrower.name_first }}</td>
				<td>{{ app.get_status_display }}</td>
				<td>{{ app.source }}</td>
				<td>{{ app.submission_date }}</td>
				<td><a href="chs_{{ app.id }}">Update Status</a></td>
				<td><a href="{{ app.id }}">View Details</a></td>
				<td><a href="cht_{{ app.id }}">Change Tier</a></td>
			</tr>
			{% endfor %}
		</table>
	{% else %}
		<p>There are no Basic Applications</p>
	{% endif %}
	<br>
	<br>
	<h2>Standard Applications:</h2>
	{% if standard %}
		<table>
			<tr>
				<th>User</th>
				<th>Property</th>
				<th>Borrower</th>
				<th>Status</th>
				<th>Source</th>
				<th>Date Last Modified</th>
			</tr>
			{% for app in standard %}
			<tr>
				<td>{{ app.user.username }}</td>
				<td>{{ app.property.address }}</td>
				<td>{{ app.borrower.name_last }}, {{ app.borrower.name_first }}</td>
				<td>{{ app.get_status_display }}</td>
				<td>{{ app.source }}</td>
				<td>{{ app.submission_date }}</td>
				<td><a href="chs_{{ app.id }}">Update Status</a></td>
				<td><a href="{{ app.id }}">View Details</a></td>
				<td><a href="cht_{{ app.id }}">Change Tier</a></td>
			</tr>
			{% endfor %}
		</table>
	{% else %}
		<p>There are no Standard Applications</p>
	{% endif %}
	
	{% if cert_basic %}
	<br>
	<br>
	<h2>Certified Basic Applications:</h2>
		<table>
			<tr>
				<th>User</th>
				<th>Property</th>
				<th>Borrower</th>
				<th>Status</th>
				<th>Date Last Modified</th>
			</tr>
			{% for app in cert_basic %}
			<tr>
				<td>{{ app.user.username }}</td>
				<td>{{ app.property.address }}</td>
				<td>{{ app.borrower.name_last }}, {{ app.borrower.name_first }}</td>
				<td>{{ app.get_status_display }}</td>
				<td>{{ app.submission_date }}</td>
				<td><a href="chs_{{ app.id }}">Update Status</a></td>
				<td><a href="{{ app.id }}">View Details</a></td>
				<td><a href="cht_{{ app.id }}">Change Tier</a></td>
			</tr>
			{% endfor %}
		</table>
	{% endif %}
	
	{% if cert_standard %}
	<br>
	<br>
	<h2>Certified Standard Applications:</h2>
		<table>
			<tr>
				<th>User</th>
				<th>Property</th>
				<th>Borrower</th>
				<th>Status</th>
				<th>Date Last Modified</th>
			</tr>
			{% for app in cert_standard %}
			<tr>
				<td>{{ app.user.username }}</td>
				<td>{{ app.property.address }}</td>
				<td>{{ app.borrower.name_last }}, {{ app.borrower.name_first }}</td>
				<td>{{ app.get_status_display }}</td>
				<td>{{ app.submission_date }}</td>
				<td><a href="chs_{{ app.id }}">Update Status</a></td>
				<td><a href="{{ app.id }}">View Details</a></td>
				<td><a href="cht_{{ app.id }}">Change Tier</a></td>
			</tr>
			{% endfor %}
		</table>
	{% endif %}
 {% endblock content %}